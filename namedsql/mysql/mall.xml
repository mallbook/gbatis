<?xml version="1.0" encoding="UTF-8" ?>
<mapper namespace="/mapper/mall">
	<select id="selectMall" resultType="bean.Mall">
	  SELECT id as ID, name as Name, avatar as Avatar, createdAt as CreatedAt, 
			updatedAt as UpdatedAt, story as Story FROM t_mall WHERE id = ?
	</select>

	<select id="selectAllMalls" resultType="bean.Mall">
	  SELECT id as ID, name as Name, avatar as Avatar, story as Story FROM t_mall
	</select>

	<select id="selectAllMalls2" resultType="bean.Mall">
	  SELECT id as ID, name as Name, avatar as Avatar, story as Story FROM ${.tableName}
	</select>

	<select id="selectMallsIn">
		SELECT id as ID, name as Name, avatar as Avatar, story as Story FROM ${.tableName}
		where id in(${in .ids})
	</select>

	<select id="selectMallsIn2">
		SELECT id as ID, name as Name, avatar as Avatar, story as Story FROM ${.tableName}
		${- if eq driver "mysql"}
			where id in(${in .ids})
		${- end}
	</select>

	<select id="selectMallsIn3">
		SELECT id as ID, name as Name, avatar as Avatar, story as Story FROM ${.tableName}
		${- if eq driver "oracle"}
			where id in(${in .ids})
		${- end}
	</select>

	<select id="selectShop" resultType="bean.Shop">
		SELECT s.id as id, name, avatar, story FROM t_shop s, t_brand b 
		where s.brandId = b.id and s.id = ?
	</select>

	<insert id="insertMall">
	  insert into t_mall(id, name, avatar, createdAt, updatedAt, story) 
			values (?, ?, ?, unix_timestamp(now()), unix_timestamp(now()), ?)
	</insert>

	<update id="updateMall">
		update t_mall set name = ?, updatedAt = unix_timestamp(now()) where id = ?
	</update>

	<update id="updateMall2">
		update ${.tableName} set name = ?, updatedAt = unix_timestamp(now()) where id = ?
	</update>

	<delete id="deleteMall">
	  delete from t_mall where id = ?
	</delete>

	<delete id="deleteShop">
	  delete from t_shop where id = ?
	</delete>

	<anysql id="createMallTable">
		CREATE TABLE IF NOT EXISTS t_mall (
			id varchar(64),
			name varchar(32),
			avatar varchar(256),
			createdAt int,
			updatedAt int,
			story varchar(1024),
			PRIMARY KEY(id)
		)ENGINE=InnoDB DEFAULT CHARSET=utf8;
	</anysql>

	<anysql id="dropMallTable">
		DROP TABLE IF EXISTS t_mall
	</anysql>
</mapper>

